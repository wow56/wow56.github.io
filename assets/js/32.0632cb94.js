(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{501:function(s,t,e){"use strict";e.r(t);var a=e(48),r=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"docker-进阶"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-进阶"}},[s._v("#")]),s._v(" Docker 进阶")]),s._v(" "),e("h2",{attrs:{id:"参考文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.runoob.com/docker/docker-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 菜鸟"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://yeasy.gitbook.io/docker_practice/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 从入门到实践"),e("OutboundLink")],1)])]),s._v(" "),e("h2",{attrs:{id:"docker-compose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker Compose")]),s._v(" "),e("h3",{attrs:{id:"简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),e("p",[s._v("我们知道通过 Dockerfile 可以很方便的定义一个单独的容器，但是一个项目中往往会包含多个容器（项目代码、Mysql、Redis...），多个容器配合才能完成一个应用。")]),s._v(" "),e("p",[s._v("Compose 就是用来编排这些容器的，它允许用户通过一个单独的 "),e("code",[s._v("docker-compose.yml")]),s._v(" 模板文件定义一组关联容器构成一个应用。Compose 中有两个重要概念：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("service")]),s._v(" 服务，一个应用实际的容器，也就是每一个微服务所在的容器，实际上可以包括多个运行相同镜像的容器实例。")]),s._v(" "),e("li",[e("code",[s._v("project")]),s._v(" 项目，有多个服务组成的一个完整的应用项目。")])]),s._v(" "),e("p",[s._v("Compose 默认管理的对象是项目，通过 Compose 可以使用 YML 文件来配置应用程序需要的所有服务。然后使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。")]),s._v(" "),e("p",[s._v("Compose v1 中的命令是 "),e("code",[s._v("docker-compose [arg]")]),s._v("，Compose v2 中的命令是 "),e("code",[s._v("docker compose [arg]")]),s._v("。")]),s._v(" "),e("h3",{attrs:{id:"compose-模板文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compose-模板文件"}},[s._v("#")]),s._v(" Compose 模板文件")]),s._v(" "),e("blockquote",[e("p",[s._v("详细参数解释可见"),e("a",{attrs:{href:"https://yeasy.gitbook.io/docker_practice/compose/compose_file",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),e("OutboundLink")],1)])]),s._v(" "),e("p",[s._v("目前主要使用到的 Compose 是 v3，所以这里默认使用 v3，其它版本可以去官方文档中查看。")]),s._v(" "),e("p",[s._v("Compose 默认使用文件名 "),e("code",[s._v("docker-compose.yml")]),s._v("。当然，也可以使用 "),e("code",[s._v("-f")]),s._v(" 参数指定具体文件。")]),s._v(" "),e("h3",{attrs:{id:"示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),e("p",[s._v("定义 "),e("code",[s._v("docker-compose.yml")]),s._v(" 放在工程根目录下，执行 "),e("code",[s._v("docker compose up")]),s._v(" 这个命令来启动并运行整个应用程序。在工程根目录下执行 "),e("code",[s._v("docker compose logs")]),s._v(" 将展示整个应用的日志信息，不同服务的日志将会以不同的颜色展示出来。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose.yml 配置")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("compose-demo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'7400:7401'")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里意思是先运行 redis，再运行当前服务")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'6374:6379'")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service - compose-demo 的 Dockfile")]),s._v("\nFROM openjdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\nADD /target/compose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("1.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("SNAPSHOT.jar app.jar\nENTRYPOINT java "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jar app.jar\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("h2",{attrs:{id:"讨论区"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#讨论区"}},[s._v("#")]),s._v(" 讨论区")]),s._v(" "),e("blockquote",[e("p",[s._v("由于评论过多会影响页面最下方的导航，故将评论区做默认折叠处理。")])]),s._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[s._v("点击查看评论区内容，渴望您的宝贵建议~")]),s._v(" "),e("Vssue",{attrs:{title:s.$title,options:{locale:"zh"}}})],1)])}),[],!1,null,null,null);t.default=r.exports}}]);